# Serena MCP Server - Python Language Support
FROM python:3.12-alpine AS base

# Install necessary tools
RUN apk add --no-cache git

# Install Serena from GitHub
RUN pip3 install git+https://github.com/oraios/serena

# Install Python language server (pylsp)
RUN pip3 install python-lsp-server

# Set up working directory
WORKDIR /workspace

# Default environment variables
ENV SERENA_CONTEXT=codex
ENV SERENA_PROJECT=/workspace

# Entrypoint runs the Serena MCP server with Python support
ENTRYPOINT ["serena", "start-mcp-server", "--context", "${SERENA_CONTEXT}", "--project", "${SERENA_PROJECT}"]
