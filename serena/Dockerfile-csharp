# Serena MCP Server - C# Language Support
FROM mcr.microsoft.com/dotnet/sdk:8.0-alpine AS base

# Install necessary tools
RUN apk add --no-cache git python3 py3-pip

# Install Serena from GitHub
RUN pip3 install --break-system-packages git+https://github.com/oraios/serena

# Install OmniSharp (C# language server)
RUN dotnet tool install --global csharp-ls

ENV PATH="${PATH}:/root/.dotnet/tools"

# Set up working directory
WORKDIR /workspace

# Default environment variables
ENV SERENA_CONTEXT=codex
ENV SERENA_PROJECT=/workspace

# Entrypoint runs the Serena MCP server with C# support
ENTRYPOINT ["serena", "start-mcp-server", "--context", "codex", "--project", "/workspace"]
